enum ORDERSTATUS {
    PLACED
    PROCESSING
    SHIPPED
    DELIVERED
    CANCELLED
}

enum USERSTATUS {
    ACTIVE
    BANNED
}

model Category {
    id        String     @id @default(cuid())
    name      String     @unique
    slug      String     @unique
    medicines Medicine[]
    createdAt DateTime   @default(now())
    updatedAt DateTime   @updatedAt

    @@map("categories")
}

model Medicine {
    id           String  @id @default(cuid())
    name         String
    description  String  @db.Text
    manufacturer String
    price        Float
    stock        Int     @default(0)
    imageUrl     String?

    categoryId String
    category   Category @relation(fields: [categoryId], references: [id])

    sellerId String

    orderItems OrderItem[]
    reviews    Review[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([sellerId])
    @@index([categoryId])
    @@map("medicines")
}

model Order {
    id          String @id @default(cuid())
    orderNumber String @unique

    customerId String

    shippingAddress String      @db.Text
    totalAmount     Float
    status          ORDERSTATUS @default(PLACED)

    items OrderItem[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([customerId])
    @@map("orders")
}

model OrderItem {
    id String @id @default(cuid())

    orderId String
    order   Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)

    medicineId String
    medicine   Medicine @relation(fields: [medicineId], references: [id])

    quantity Int
    price    Float

    createdAt DateTime @default(now())

    @@index([orderId])
    @@index([medicineId])
    @@map("order_items")
}

model Review {
    id      String  @id @default(cuid())
    rating  Int // 1-5
    comment String? @db.Text

    customerId String

    medicineId String
    medicine   Medicine @relation(fields: [medicineId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([customerId])
    @@index([medicineId])
    @@map("reviews")
}
